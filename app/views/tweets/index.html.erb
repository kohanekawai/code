<h3>Tweet一覧</h3>
<%= link_to "新規投稿へ", new_tweet_path %>

<h3>タグリスト</h3>
<%= form_tag({controller: "tweets", action: "index"}, method: :get) do %>
  <% Tag.all.each do |tag| %>
    <li><%= check_box :tag_ids, tag.tag_name %><%= tag.tag_name %></li>
  <% end %>
  <%= submit_tag '検索' %>
<% end %>

<div class="tweets-container">
  <% @tweets.each do |t| %>
    <div class="tweet">
      <%= image_tag t.image_url, size: "250x200" if t.image? %><br>
      <%= t.item %>
      <%= t.point %>
      <% t.tags.each do |tag| %>
        <%= link_to tag.tag_name, tag_tweets_path(tag_id: tag.id) %>
      <% end %>
      
      <% if user_signed_in? %>
        <% if current_user.already_liked?(t) %>
          <% like = current_user.likes.find_by(tweet_id: t.id) %>
          <%= link_to tweet_like_path(t, like), data: { turbo_method: :delete } do %>
            いいねを取り消す <%= t.likes.count %>
          <% end %>
        <% else %>
          <%= link_to tweet_likes_path(t), data: { turbo_method: :post } do %>
            いいね <%= t.likes.count %>
          <% end %>
        <% end %>
      <% end %>
    <%= button_to "削除する", tweet_path(t.id), method: :delete %>
    </div>
  <% end %>
</div>